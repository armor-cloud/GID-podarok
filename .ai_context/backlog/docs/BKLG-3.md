# üîó BKLG-3: –î–æ–±–∞–≤–∏—Ç—å UTM-–º–µ—Ç–∫–∏

## üìã –û–ø–∏—Å–∞–Ω–∏–µ
–≠–ø–∏–∫ –ø–æ –¥–æ–±–∞–≤–ª–µ–Ω–∏—é UTM-—Ä–∞–∑–º–µ—Ç–∫–∏ –¥–ª—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è –ø–µ—Ä–µ—Ö–æ–¥–æ–≤ –ø–æ —Å—Å—ã–ª–∫–∞–º –∏–∑ –æ–ø–∏—Å–∞–Ω–∏—è –ø–æ–¥–∞—Ä–∫–æ–≤. –í—Å–µ –ø–µ—Ä–µ—Ö–æ–¥—ã –¥–æ–ª–∂–Ω—ã –¥–æ–ø–æ–ª–Ω—è—Ç—å—Å—è UTM-–º–µ—Ç–∫–æ–π `gid-gift`.

## üéØ –¶–µ–ª–∏
- –î–æ–±–∞–≤–∏—Ç—å UTM-–º–µ—Ç–∫—É `gid-gift` –∫–æ –≤—Å–µ–º —Å—Å—ã–ª–∫–∞–º –≤ –æ–ø–∏—Å–∞–Ω–∏—è—Ö –ø–æ–¥–∞—Ä–∫–æ–≤
- –û–±–µ—Å–ø–µ—á–∏—Ç—å –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–µ –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –ø–µ—Ä–µ—Ö–æ–¥–æ–≤
- –ò–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞—Ç—å —Å —Å–∏—Å—Ç–µ–º–æ–π –∞–Ω–∞–ª–∏—Ç–∏–∫–∏
- –°–æ—Ö—Ä–∞–Ω–∏—Ç—å —Å—É—â–µ—Å—Ç–≤—É—é—â—É—é —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å —Å—Å—ã–ª–æ–∫

## üìù –ü–æ–¥–∑–∞–¥–∞—á–∏

### 1. –°–æ–∑–¥–∞–Ω–∏–µ UTM-—É—Ç–∏–ª–∏—Ç—ã
- **–§–∞–π–ª—ã**: `src/utils/utmHelper.ts`
- **–û–ø–∏—Å–∞–Ω–∏–µ**: –°–æ–∑–¥–∞—Ç—å —É—Ç–∏–ª–∏—Ç—É –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å UTM-–º–µ—Ç–∫–∞–º–∏
- **–¢—Ä–µ–±–æ–≤–∞–Ω–∏—è**:
  - –§—É–Ω–∫—Ü–∏—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è UTM-–º–µ—Ç–æ–∫ –∫ URL
  - –§—É–Ω–∫—Ü–∏—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –Ω–∞–ª–∏—á–∏—è UTM-–º–µ—Ç–æ–∫
  - –ü–æ–¥–¥–µ—Ä–∂–∫–∞ —Ä–∞–∑–ª–∏—á–Ω—ã—Ö —Ñ–æ—Ä–º–∞—Ç–æ–≤ URL
  - –í–∞–ª–∏–¥–∞—Ü–∏—è UTM-–ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤

### 2. –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞ GiftCard
- **–§–∞–π–ª—ã**: `src/components/GiftCard.tsx`, `src/components/GiftCard.css`
- **–û–ø–∏—Å–∞–Ω–∏–µ**: –ú–æ–¥–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞—Ç—å –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Å—Å—ã–ª–æ–∫ –≤ –∫–∞—Ä—Ç–æ—á–∫–∞—Ö –ø–æ–¥–∞—Ä–∫–æ–≤
- **–¢—Ä–µ–±–æ–≤–∞–Ω–∏—è**:
  - –î–æ–±–∞–≤–∏—Ç—å UTM-–º–µ—Ç–∫–∏ –∫–æ –≤—Å–µ–º —Å—Å—ã–ª–∫–∞–º –≤ –æ–ø–∏—Å–∞–Ω–∏–∏
  - –°–æ—Ö—Ä–∞–Ω–∏—Ç—å —Å—É—â–µ—Å—Ç–≤—É—é—â—É—é —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å
  - –û–±–µ—Å–ø–µ—á–∏—Ç—å –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–µ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Å—Å—ã–ª–æ–∫

### 3. –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø–æ–ø–∞–ø–∞ –¥–µ—Ç–∞–ª–µ–π –ø–æ–¥–∞—Ä–∫–∞
- **–§–∞–π–ª—ã**: `src/components/GiftDetailsPopup.tsx`
- **–û–ø–∏—Å–∞–Ω–∏–µ**: –î–æ–±–∞–≤–∏—Ç—å UTM-–º–µ—Ç–∫–∏ –∫ —Å—Å—ã–ª–∫–∞–º –≤ –ø–æ–ø–∞–ø–µ –¥–µ—Ç–∞–ª–µ–π
- **–¢—Ä–µ–±–æ–≤–∞–Ω–∏—è**:
  - –ú–æ–¥–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞—Ç—å —Ñ—É–Ω–∫—Ü–∏—é `renderDetailsWithLinks`
  - –î–æ–±–∞–≤–∏—Ç—å UTM-–º–µ—Ç–∫–∏ –∫ —Å—Å—ã–ª–∫–∞–º –≤ –æ–ø–∏—Å–∞–Ω–∏–∏
  - –°–æ—Ö—Ä–∞–Ω–∏—Ç—å —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å –æ—Ç–∫—Ä—ã—Ç–∏—è –≤ –Ω–æ–≤–æ–π –≤–∫–ª–∞–¥–∫–µ

### 4. –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ API —Å—Ö–µ–º
- **–§–∞–π–ª—ã**: `my-gift-service-backend/schemas.py`, `my-gift-service-backend/models.py`
- **–û–ø–∏—Å–∞–Ω–∏–µ**: –î–æ–±–∞–≤–∏—Ç—å –ø–æ–ª—è –¥–ª—è UTM-–º–µ—Ç–æ–∫ –≤ –º–æ–¥–µ–ª–∏ –ø–æ–¥–∞—Ä–∫–æ–≤
- **–¢—Ä–µ–±–æ–≤–∞–Ω–∏—è**:
  - –î–æ–±–∞–≤–∏—Ç—å –ø–æ–ª–µ `utm_source` (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é "gid-gift")
  - –î–æ–±–∞–≤–∏—Ç—å –ø–æ–ª–µ `utm_medium` (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é "gift")
  - –î–æ–±–∞–≤–∏—Ç—å –ø–æ–ª–µ `utm_campaign` (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
  - –û–±–Ω–æ–≤–∏—Ç—å Pydantic —Å—Ö–µ–º—ã

### 5. –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å –∞–Ω–∞–ª–∏—Ç–∏–∫–æ–π
- **–§–∞–π–ª—ã**: `src/utils/analytics.ts`
- **–û–ø–∏—Å–∞–Ω–∏–µ**: –°–æ–∑–¥–∞—Ç—å —É—Ç–∏–ª–∏—Ç—É –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏ —Å–æ–±—ã—Ç–∏–π –≤ –∞–Ω–∞–ª–∏—Ç–∏–∫—É
- **–¢—Ä–µ–±–æ–≤–∞–Ω–∏—è**:
  - –û—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –∫–ª–∏–∫–æ–≤ –ø–æ —Å—Å—ã–ª–∫–∞–º —Å UTM-–º–µ—Ç–∫–∞–º–∏
  - –û—Ç–ø—Ä–∞–≤–∫–∞ —Å–æ–±—ã—Ç–∏–π –≤ –Ø–Ω–¥–µ–∫—Å.–ú–µ—Ç—Ä–∏–∫—É
  - –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–µ—Ä–µ—Ö–æ–¥–æ–≤

## üîß –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è

### UTM-–ø–∞—Ä–∞–º–µ—Ç—Ä—ã
- **utm_source**: `gid-gift` (—Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ)
- **utm_medium**: `gift` (—Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ)
- **utm_campaign**: –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –ø–æ–¥–∞—Ä–∫–∞
- **utm_content**: ID –ø–æ–¥–∞—Ä–∫–∞ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
- **utm_term**: –Ω–∞–∑–≤–∞–Ω–∏–µ –ø–æ–¥–∞—Ä–∫–∞ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)

### –§–æ—Ä–º–∞—Ç URL
```
https://example.com/page?utm_source=gid-gift&utm_medium=gift&utm_campaign=campaign_name
```

### Frontend
- –°–æ–∑–¥–∞—Ç—å —É—Ç–∏–ª–∏—Ç—É `utmHelper.ts` —Å —Ñ—É–Ω–∫—Ü–∏—è–º–∏:
  - `addUtmParams(url: string, campaign?: string): string`
  - `hasUtmParams(url: string): boolean`
  - `getUtmParams(url: string): object`
- –û–±–Ω–æ–≤–∏—Ç—å –≤—Å–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã, –æ—Ç–æ–±—Ä–∞–∂–∞—é—â–∏–µ —Å—Å—ã–ª–∫–∏
- –î–æ–±–∞–≤–∏—Ç—å –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –∫–ª–∏–∫–æ–≤ –¥–ª—è –∞–Ω–∞–ª–∏—Ç–∏–∫–∏

### Backend
- –î–æ–±–∞–≤–∏—Ç—å –ø–æ–ª—è UTM –≤ –º–æ–¥–µ–ª—å Gift
- –°–æ–∑–¥–∞—Ç—å –º–∏–≥—Ä–∞—Ü–∏—é –¥–ª—è –Ω–æ–≤—ã—Ö –ø–æ–ª–µ–π
- –û–±–Ω–æ–≤–∏—Ç—å API —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å UTM-–º–µ—Ç–∫–∞–º–∏
- –î–æ–±–∞–≤–∏—Ç—å –≤–∞–ª–∏–¥–∞—Ü–∏—é UTM-–ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤

## üìä –ö—Ä–∏—Ç–µ—Ä–∏–∏ –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏
- [ ] UTM-—É—Ç–∏–ª–∏—Ç–∞ —Å–æ–∑–¥–∞–Ω–∞ –∏ —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
- [ ] –í—Å–µ —Å—Å—ã–ª–∫–∏ –≤ –æ–ø–∏—Å–∞–Ω–∏—è—Ö –ø–æ–¥–∞—Ä–∫–æ–≤ —Å–æ–¥–µ—Ä–∂–∞—Ç UTM-–º–µ—Ç–∫–∏
- [ ] –ü–æ–ø–∞–ø –¥–µ—Ç–∞–ª–µ–π –ø–æ–¥–∞—Ä–∫–∞ –æ–±–Ω–æ–≤–ª–µ–Ω
- [ ] API —Å—Ö–µ–º—ã –æ–±–Ω–æ–≤–ª–µ–Ω—ã
- [ ] –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å –∞–Ω–∞–ª–∏—Ç–∏–∫–æ–π —Ä–∞–±–æ—Ç–∞–µ—Ç
- [ ] –î–æ–±–∞–≤–ª–µ–Ω—ã —Ç–µ—Å—Ç—ã –¥–ª—è UTM-—Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç–∏
- [ ] –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –ø–æ UTM-–º–µ—Ç–∫–∞–º —Å–æ–∑–¥–∞–Ω–∞

## üé® UI/UX —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è
- –°—Å—ã–ª–∫–∏ –¥–æ–ª–∂–Ω—ã –≤—ã–≥–ª—è–¥–µ—Ç—å –∫–∞–∫ –æ–±—ã—á–Ω—ã–µ —Å—Å—ã–ª–∫–∏
- –ù–µ –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å –≤–∏–∑—É–∞–ª—å–Ω—ã—Ö –∏–∑–º–µ–Ω–µ–Ω–∏–π –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç–∏ –æ—Ç–∫—Ä—ã—Ç–∏—è –≤ –Ω–æ–≤–æ–π –≤–∫–ª–∞–¥–∫–µ
- –ö–æ—Ä—Ä–µ–∫—Ç–Ω–∞—è —Ä–∞–±–æ—Ç–∞ –Ω–∞ –º–æ–±–∏–ª—å–Ω—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞—Ö

## üìã –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

### –ü—Ä–∏–º–µ—Ä 1: –ü—Ä–æ—Å—Ç–∞—è —Å—Å—ã–ª–∫–∞
```typescript
// –ò—Å—Ö–æ–¥–Ω—ã–π URL
const url = "https://gazprombonus.ru/activate";

// –° UTM-–º–µ—Ç–∫–∞–º–∏
const urlWithUtm = addUtmParams(url, "gazprom-bonus");
// –†–µ–∑—É–ª—å—Ç–∞—Ç: https://gazprombonus.ru/activate?utm_source=gid-gift&utm_medium=gift&utm_campaign=gazprom-bonus
```

### –ü—Ä–∏–º–µ—Ä 2: –°—Å—ã–ª–∫–∞ —Å —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–º–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏
```typescript
// –ò—Å—Ö–æ–¥–Ω—ã–π URL
const url = "https://gid.ru/fuel?ref=123";

// –° UTM-–º–µ—Ç–∫–∞–º–∏
const urlWithUtm = addUtmParams(url, "gid-fuel");
// –†–µ–∑—É–ª—å—Ç–∞—Ç: https://gid.ru/fuel?ref=123&utm_source=gid-gift&utm_medium=gift&utm_campaign=gid-fuel
```

## üîó –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
- BKLG-4: –î–æ–±–∞–≤–∏—Ç—å –Ø–Ω–¥–µ–∫—Å.–ú–µ—Ç—Ä–∏–∫—É (–¥–ª—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ —Å –∞–Ω–∞–ª–∏—Ç–∏–∫–æ–π)

## üìà –ê–Ω–∞–ª–∏—Ç–∏–∫–∞
- –û—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –∫–ª–∏–∫–æ–≤ –ø–æ —Å—Å—ã–ª–∫–∞–º —Å UTM-–º–µ—Ç–∫–∞–º–∏
- –°–±–æ—Ä –¥–∞–Ω–Ω—ã—Ö –æ –ø–æ–ø—É–ª—è—Ä–Ω–æ—Å—Ç–∏ –ø–æ–¥–∞—Ä–∫–æ–≤
- –ê–Ω–∞–ª–∏–∑ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ –∫–∞–º–ø–∞–Ω–∏–π
- –û—Ç—á–µ—Ç—ã –ø–æ –ø–µ—Ä–µ—Ö–æ–¥–∞–º 